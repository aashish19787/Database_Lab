CREATE DATABASE COMPANYDB;
USE COMPANYDB;

CREATE TABLE DEPARTMENT (
DNAME VARCHAR(20),
DNUMBER INT PRIMARY KEY,
MGRSSN VARCHAR(15),
MGRSTARTDATE DATE
);
CREATE TABLE EMPLOYEE (
FNAME VARCHAR(20),
MINIT CHAR(1),
LNAME VARCHAR(15),
SSN VARCHAR(15) PRIMARY KEY,
BDATE DATE,
ADDRESS VARCHAR(100),
SEX CHAR(1),
SALARY INT,
SUPERSSN VARCHAR(15),
DNO INT,
FOREIGN KEY(DNO) REFERENCES DEPARTMENT(DNUMBER)
);

INSERT INTO DEPARTMENT (DNAME, DNUMBER, MGRSSN, MGRSTARTDATE) VALUES
('Research', 1, '111-11-1111', '2018-01-10'),
('Administration', 2, '222-22-2222', '2019-03-15'),
('IT', 3, '333-33-3333', '2020-06-01'),
('Marketing', 4, '444-44-4444', '2021-09-20');

INSERT INTO EMPLOYEE (FNAME, MINIT, LNAME, SSN, BDATE, ADDRESS, SEX, SALARY, SUPERSSN, DNO) VALUES
('Byanjan', 'B', 'Bhusal', '111-11-1111', '1999-05-12', 'Kathmandu, Nepal', 'M', 80000, NULL, 1),
('Suman', 'K', 'Shrestha', '222-22-2222', '1998-08-21', 'Lalitpur, Nepal', 'M', 90000, '111-11-1111', 2),
('Anita', 'R', 'Karki', '333-33-3333', '2000-01-30', 'Bhaktapur, Nepal', 'F', 85000, '111-11-1111', 3),
('Ramesh', 'S', 'Adhikari', '444-44-4444', '1997-11-18', 'Pokhara, Nepal', 'M', 75000, '222-22-2222', 4),
('Nisha', 'M', 'Gurung', '555-55-5555', '2001-04-25', 'Chitwan, Nepal', 'F', 60000, '333-33-3333', 3);

SELECT * FROM DEPARTMENT;
SELECT * FROM EMPLOYEE;

#QN.1 10% Salary Raise for Research Department.
SELECT E.FNAME,E.LNAME,
E.SALARY * 1.1 AS INCREASED_SALARY
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DNO = D.DNUMBER
WHERE D.DNAME = 'Research';

#QN.2 Salary Statistics of Account Department.
# Sum, Max, Min, Avg for department admininstration.
SELECT SUM(E.SALARY), 
MAX(E.SALARY), 
MIN(E.SALARY), 
AVG(E.SALARY)
FROM EMPLOYEE E
JOIN DEPARTMENT D ON E.DNO = D.DNUMBER
WHERE D.DNAME = 'Administration';

#QN.3 Employees controlled by department no 4.
SELECT FNAME, LNAME
FROM EMPLOYEE
WHERE DNO = 4;

#QN.4 Department having At least 2 Employees.
SELECT D.DNUMBER,D.DNAME,
COUNT(E.SSN) AS TotalEmployees
FROM DEPARTMENT D
JOIN EMPLOYEE E
ON D.DNUMBER = E.DNO
GROUP BY D.DNUMBER, D.DNAME
HAVING COUNT(E.SSN) >= 2;

#QN.5 Employees Born in 1990's.
SELECT FNAME, LNAME, BDATE
FROM EMPLOYEE
WHERE BDATE BETWEEN '1990-01-01' AND '1999-12-31';
